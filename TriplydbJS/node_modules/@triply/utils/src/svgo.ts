export default function () {
  return {
    plugins: [
      { removeScriptElement: true },
      //Inlines items from <style> tags. Useful, as svgo svg->png conversion doesnt take into account the <style>
      {
        inlineStyles: {
          onlyMatchedOnce: false,
        },
      },
      //removes width/height if viewbox is present. A width/height is annoying in IE11
      //see https://gist.github.com/larrybotha/7881691
      {
        dimensionsToViewbox: {
          type: "full", // full, perItem or perItemReverse
          description: "Set dimensions as viewbox",
          params: {}, // some arbitrary data
          fn: function (item: any, _params: any) {
            if (item && item.content && item.content[0]) {
              const svg = item.content[0];
              if (svg.isElem("svg")) {
                if (svg.hasAttr("width") && svg.hasAttr("height")) {
                  const width = svg.attr("width").value;
                  const height = svg.attr("height").value;
                  if (!isNaN(Number(width)) && !isNaN(Number(height))) {
                    // both are expressed in ints, thus satisfying the viewbox spec
                    if (!svg.hasAttr("viewBox")) {
                      svg.addAttr({
                        value: `0 0 ${width} ${height}`,
                        name: "viewBox",
                        local: "viewBox",
                        prefix: "",
                      });
                    }
                    svg.removeAttr("width");
                    svg.removeAttr("height");
                  }
                }
              }
            }
            // custom plugin code goes here
            return item;
          },
        },
      },
    ],
  };
}
