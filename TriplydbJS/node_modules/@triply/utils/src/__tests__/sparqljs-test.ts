import * as chai from "chai";
import path from "path";

var expect = chai.expect;

import fs from "fs-extra";

import { getParser } from "../sparqlVarUtils";
const parser = getParser();

const TEST_DIR = "./src/__tests__/queries";

describe("Testing sparqlJs queries", () => {
  it("looping through static files", async () => {
    const testFiles = await fs.readdir(TEST_DIR);
    for (const file of testFiles) {
      if (file.endsWith(".skip")) continue;
      const query = (await fs.readFile(path.resolve(TEST_DIR, file))).toString();
      try {
        expect(() => parser.parse(query)).not.to.throw;
      } catch (e) {
        e.message = `Test of ${file} failed:\n${e.message}`;
        throw e;
      }
    }
  });
});
